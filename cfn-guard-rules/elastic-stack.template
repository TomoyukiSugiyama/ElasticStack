# let aws_cloudformation_stack_resources = Resources.*[ Type == 'AWS::CloudFormation::Stack' ]
# rule aws_cloudformation_stack when %aws_cloudformation_stack_resources !empty {
#   %aws_cloudformation_stack_resources.Properties.Parameters IN [{"SubnetIds":"Network.Outputs.PrivateSubnetIds","SecurityGroupId":"SecurityGroup.Outputs.OpenSearchSecurityGroupId","InstanceType":"t3.small.search"}, {"VpcId":"Network.Outputs.VpcId","VpcCidrBlock":"VpcCidrBlock"}, {"VpcId":"Network.Outputs.VpcId","SubnetIds":"Network.Outputs.PrivateSubnetIds","SecurityGroupId":"SecurityGroup.Outputs.AlbSecurityGroupId","PrivateIPv4Address1":"PrivateIPv4Address1","PrivateIPv4Address2":"PrivateIPv4Address2","PrivateIPv4Address3":"PrivateIPv4Address3","LogExpirationInDays":"LogExpirationInDays"}, {"VpcId":"Network.Outputs.VpcId","SubnetIds":"Network.Outputs.PrivateSubnetIds","SecurityGroupId":"SecurityGroup.Outputs.VpcEndpointSecurityGroupId","PrivateRouteTableId":"Network.Outputs.PrivateRouteTableId"}, {"SubnetIds":"Network.Outputs.PrivateSubnetIds","SecurityGroupId":"SecurityGroup.Outputs.VpcEndpointSecurityGroupId","NlbId":"Elb.Outputs.NlbId","NlbTargetGroupId":"Elb.Outputs.NlbTargetGroupId","ClusterId":"LogstashFargate.Outputs.ClusterId","LogExpirationInDays":"LogExpirationInDays"}, {"VpcId":"Network.Outputs.VpcId","SubnetIds":"Network.Outputs.PrivateSubnetIds","SecurityGroupId":"SecurityGroup.Outputs.FargateSecurityGroupId","LbTargetGroupId":"Elb.Outputs.NlbTargetGroupId","LogExpirationInDays":"LogExpirationInDays"}, {"VpcCidrBlock":"VpcCidrBlock","LogExpirationInDays":"LogExpirationInDays"}, {"KeyName":"elastic-stack","SubnetId":"Network.Outputs.PublicSubnet1Id","SecurityGroupId":"SecurityGroup.Outputs.SecurityGroupId"}, {"SubnetIds":"Network.Outputs.PrivateSubnetIds","SecurityGroupId":"SecurityGroup.Outputs.VpcEndpointSecurityGroupId","DomainEndpoint":"Opensearch.Outputs.DomainEndpoint","AlbId":"Elb.Outputs.AlbId","AlbTargetGroupId":"Elb.Outputs.AlbTargetGroupId","LogExpirationInDays":"LogExpirationInDays"}]
#   %aws_cloudformation_stack_resources.Properties.TemplateURL IN ["vpc-endpoint.yaml", "security-group.yaml", "ec2.yaml", "guard-duty.yaml", "elb.yaml", "lambda.yaml", "logstash-fargate.yaml", "network.yaml", "opensearch.yaml", "lambda-for-fargate-spot.yaml"]
# }
